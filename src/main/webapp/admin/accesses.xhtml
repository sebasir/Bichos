<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core">
	
	<h:form id="formUsers">
		<div class="panel panel-default">
			<div class="panel-heading">Usuarios</div>
			<div class="panel-body">
				<div class="form-group">
					<div class="row">
						<label class="col-md-2 control-label" for="numeroIden">Numero
						Identificación:</label>
						<div class="col-md-2">
							<h:inputText id="numeroIden"
								styleClass="ui-state-default form-control input-sm input-block-level required"
								value="#{accessesBean.searchUser.userIdNumber}">
								<p:ajax process="@this" />
								<f:validateBean disabled="true" />
							</h:inputText>
						</div>
						<label class="col-md-2 control-label" for="email">Correo
						Electronico:</label>
						<div class="col-md-2">
							<h:inputText id="email"
								styleClass="ui-state-default form-control input-sm input-block-level required"
								value="#{accessesBean.searchUser.userEmail}">
								<p:ajax process="@this" />
								<f:validateBean disabled="true" />
							</h:inputText>
						</div>
					</div>
					<div class="row">
						<label class="col-md-2 control-label" for="ins">Institución:</label>
						<div class="col-md-5">
							<h:selectOneMenu id="ins" class="form-control" value="#{accessesBean.searchUser.idInstitution}"
							    styleClass="ui-state-default form-control input-sm input-block-level required"
							    converter="InstitutionConverter" >
								<f:selectItem itemValue="#{null}" itemLabel="Selecciona"/>
								<f:selectItems value="#{accessesBean.allInstitutions}" var="inst" itemLabel="#{inst.institutionName}"
									itemValue="#{inst}" />
								<p:ajax process="@this" />
							</h:selectOneMenu>
						</div>
					</div>
				</div>
				<hr />
				<h:panelGroup layout="block"
					rendered="#{accessesBean.searchUsers != null and !accessesBean.searchUsers.isEmpty()}"
					styleClass="pull-right">
					<p>
						Mostrando <b>#{accessesBean.searchUsers.size()}</b> de <b>#{accessesBean.usersPager.numberOfResults}</b>
						registros
					</p>
				</h:panelGroup>
				<p:commandButton id="search"
					actionListener="#{accessesBean.searchUser()}" update="formUsers"
					value="Consultar" />
				<p:commandButton id="clear"
					actionListener="#{accessesBean.limpiarFiltros()}"
					update="formUsers" value="Limpiar" />
			</div>
			<h:dataTable id="dataTableUsers"
				rendered="#{accessesBean.searchUsers != null and !accessesBean.searchUsers.isEmpty()}"
				value="#{accessesBean.searchUsers}" var="users"
				styleClass="table table-hover table-condensed">
				<h:column>
					<f:facet name="header">Nombres</f:facet>
					<h:outputText value="#{users.userNames} #{users.userLastnames}" />
				</h:column>
				<h:column>
					<f:facet name="header">Correo Institucional</f:facet>
					<h:outputText value="#{users.userEmail}" />
				</h:column>
				<h:column>
					<f:facet name="header">Institución</f:facet>
					<h:outputText value="#{users.idInstitution.institutionName}" />
				</h:column>
				<h:column>
					<f:facet name="header">Acciones</f:facet>
					<p:commandLink id="viewButton"
						class="btn btn-default btn-sm btn-action"
						title="Editar #{users.userNames} #{users.userLastnames}" ajax="false">
						<f:actionListener binding="#{navigationBean.setNavigablePage('modules.xhtml')}"/>
    					<f:actionListener binding="#{accessesBean.loadUsersModules(users)}"/>
						<span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
					</p:commandLink>
				</h:column>
			</h:dataTable>
			<h:panelGroup id="paginator"
				rendered="#{accessesBean.searchUsers != null and !accessesBean.searchUsers.isEmpty()}">
				<nav aria-label="Page navigation" class="paginador">
					<ul class="pagination pagination-lg">
						<li><p:commandLink id="first" title="Primera página"
								actionListener="#{accessesBean.usersPager.firstPage()}"
								update="dataTableUsers, paginator">
								<span class="glyphicon glyphicon-chevron-left"
									aria-hidden="true"></span>
							</p:commandLink></li>
						<li><p:commandLink id="prev" title="Anterior página"
								actionListener="#{accessesBean.usersPager.previousPage()}"
								update="dataTableUsers, paginator">
								<span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span>
							</p:commandLink></li>
						<ui:repeat id="pager" var="i" value="#{accessesBean.usersPager.pages}">
							<li><p:commandLink id="pageNumer"
									actionListener="#{accessesBean.usersPager.getPageResults(i)}"
									class="#{accessesBean.usersPager.currentPage == i? 'active-page': ''}"
									update="formUsers:paginator, formUsers:dataTableUsers">#{i}</p:commandLink></li>
						</ui:repeat>
						<li><p:commandLink id="next" title="Siguiente página"
								actionListener="#{accessesBean.usersPager.nextPage()}"
								update="dataTableUsers, paginator">
								<span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
							</p:commandLink></li>
						<li><p:commandLink id="last" title="Última página"
								actionListener="#{accessesBean.usersPager.lastPage()}"
								update="dataTableUsers, paginator">
								<span class="glyphicon glyphicon-chevron-right"
									aria-hidden="true"></span>
							</p:commandLink></li>
					</ul>
				</nav>
			</h:panelGroup>
		</div>
		<p:growl id="messages" showDetail="true" />
	</h:form>
</ui:composition>